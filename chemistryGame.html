
<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>Test dragging</title>
	<script type="text/javascript" src="js/phaser.min.js"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>

<script type="text/javascript">

var game = new Phaser.Game(800, 600, Phaser.AUTO, 'phaser-example', { preload: preload, create: create, update: update});
var molecule;
function preload() {
	  game.load.spritesheet('button', 'assets/buttons/button_sprite_sheet.png', 193, 71);
    game.load.image('grid', 'assets/tests/debug-grid-1920x1920.png');
		game.load.image('C', 'C atoom.png');
		game.load.image('H', 'HAtoom.jpg');
		game.load.image('O', 'OAtoom.jpg');
}

function create() {
		game.stage.backgroundColor = "#ADD8E6";
		button = game.add.button(0, 200, 'button', actionOnClick, this, 'C','C', 'C');

		// make text for first question.
		var style = { font: "20px Arial", fill: "#000000", align: "center" };
    var text = game.add.text(game.world.centerX, 550, "You need to make water now!	", style);
    text.anchor.set(0.5);
		// make object of molecule H20:
		var atoms = [];
		atoms.push(new atom('C'));
		atoms.push(new atom('C'));
		atoms.push(new atom('C'));
		molecule = new molecule(atoms);
		var question1 = new question(molecule, 'Je moet nu water maken!');
		var scaleX = 0.02;
  	var scaleY = 0.02;

		for(var i=0; i<molecule.atoms.length; i++){
			var image = molecule.atoms[i].image;
	  	image.inputEnabled = true;
	    image.input.enableDrag();
	  	image.scale.set(scaleX , scaleY);
			image.input.enableDrag(true);
			image.input.enableSnap(32, 32, false, true);
	}
		// game.physics.archade.distanceToXY(cAtom, 0, 0)
}

// function makeMolecule(){
// 	var molecule = [];
// 	var c1 = new atom('C');
// 	var c2 = new atom('C');
// 	molecule.push(c1);
// 	molecule.push(c2);
// 	return molecule;
// }
// object of an atam with a certain value.
function atom(value) {
    this.value = value
		this.image = game.add.sprite(5, 100, value);
}
// object of a molecule with different sorts of atoms
function molecule(atoms){
		this.atoms = atoms;
}
// object of a question with a particular molecule that has to be made and the mission text
function question(molecule, text){
	this.molecule = molecule;
	this.text = text;
}

function actionOnClick(){
	console.log("hallooooo");
}

// This function checks whether two molecules are close and snaps them together.
function snapToAtom(molecule){
	for(var j = 0; j< molecule.atoms.length; j++){
		var nearAny = false;
		for(var k = 0; k < molecule.atoms.length; k++){
			if(k != j){
				var distance = game.physics.arcade.distanceBetween(molecule.atoms[j].image, molecule.atoms[k].image);
				console.log(distance);
				if(distance < 64)
						nearAny = true;
			}
		}
		// Better solution to an if statement
		molecule.atoms[j].image.input.enableSnap(32, 32, nearAny, true);
	}
}

// This update function checks whether two molecules are close to each other and then snaps.
function update() {
	snapToAtom(molecule);

	// var distance = game.physics.arcade.distanceBetween(molecule.atoms[0].image, molecule.atoms[1].image);
	// //console.log(distance);
	// if(distance < 64){
	// 	//molecule[0].image.input.draggable = false;
	// 	//molecule[1].image.input.draggable = false;
	// 	for(var i=0; i<molecule.atoms.length; i++){
	// 		molecule.atoms[i].image.input.enableSnap(32, 32, true, true);
	// 	}
	// 	console.log("ik zit in de if");
	// }
	// else {
	// 	for(var i=0; i<molecule.atoms.length; i++){
	// 		molecule.atoms[i].image.input.enableSnap(32, 32, false, true);
	// 	}
	// }
}



</script>
</body>
</html>
